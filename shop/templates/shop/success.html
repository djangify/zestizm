{% extends "base.html" %}

{% block content %}
<section class="w-full bg-[color:var(--color-brand-light)] py-16">
  <div class="max-w-4xl mx-auto px-6">
    <div class="bg-white rounded-xl shadow-md p-10 text-center">

      <!-- Success Icon -->
      <div class="mb-6">
        <svg class="w-20 h-20 mx-auto text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>

      <!-- Title -->
      <h1 class="text-3xl font-bold text-[color:var(--color-brand-primary)] mb-4">
        Payment Successful!
      </h1>

      <p class="text-lg text-[color:var(--color-font-main)]/80 mb-8">
        Thank you for your purchase. You will receive an email confirmation shortly.
        You can download your order from your profile area.
      </p>

      <!-- User Confirmation -->
      {% if request.user.is_authenticated %}
      <div class="mt-6 p-4 border border-green-200 rounded-md bg-green-50 text-green-800 text-sm">
        <p>
          Thank you,
          <strong>{{ request.user.get_full_name|default:request.user.username }}</strong>.
          A receipt has been sent to
          <strong>{{ request.user.email }}</strong>.
        </p>
      </div>
      {% endif %}

      <!-- Order Details -->
      <div class="bg-gray-50 rounded-lg shadow-inner p-6 my-8 text-left max-w-md mx-auto">
        <h2 class="text-xl font-semibold mb-4 text-[color:var(--color-font-main)]">
          Order Details
        </h2>
        <p class="text-[color:var(--color-font-main)] mb-2">
          <strong>Order ID:</strong> {{ order.id }}
        </p>
        <p class="text-[color:var(--color-font-main)]">
          <strong>Total Amount:</strong> Â£{{ order.get_total_cost|floatformat:2 }}
        </p>
      </div>

      <!-- Guest CTA -->
      {% if is_guest %}
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8 max-w-md mx-auto text-left">
        <h3 class="text-lg font-semibold text-yellow-800 mb-2">Create an Account</h3>
        <p class="text-yellow-700 mb-4">
          Create an account to track your purchases and access your downloads anytime.
        </p>
        <a href="{% url 'accounts:login' %}?email={{ order.guest_details.email }}"
           class="inline-block px-6 py-3 rounded-lg bg-[color:var(--color-brand-accent)] text-white font-semibold hover:opacity-90 transition">
          Create Account
        </a>
      </div>
      {% endif %}

      <!-- Actions -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-6">
        {% if not is_guest %}
        <a href="{% url 'shop:purchases' %}"
           class="px-6 py-3 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700 transition">
          Download Your Purchase
        </a>
        {% endif %}
        <a href="{% url 'core:home' %}#latest-products"
           class="px-6 py-3 rounded-lg bg-[color:var(--color-brand-secondary)] text-white font-semibold hover:bg-[color:var(--color-brand-primary)] transition">
          Continue Shopping
        </a>
      </div>

    </div>
  </div>
</section>
{% endblock %}
